{% extends 'export_all.html' %}

{% macro render_publication_list() %}
{% set counter = 0 %}
{% for year in articles|groupby('pub_date.year')|reverse %}
	{% for article in year.list %}
	<p>{{ article.title }}</p>
	<dl class="dl-horizontal">
		
		<dt>Authors</dt>
		{% for author in article.authors %}
			<dd>{{ author.first }} {% if author.middle %}{{ author.middle }} {% endif %}{{ author.last }}{% if loop.last %}</dd>{% else %}<br /> {% endif %}
		{% endfor %}

		<dt>Title</dt>
		<dd>{{ article.title }}</dd>

		<dt>Journal</dt>
		<dd>{% if article.journal.abbreviation %}{{ article.journal.abbreviation }}{% else %}{{ article.journal.name }}{% endif %}</dd>
	 
		<dt>Year</dt>
		<dd>{{ article.pub_date.year }}){% if article.volume %} {{ article.volume }}{% if article.issue %}:{{ article.issue }}{% endif %}{% endif %}{% if article.pages %}, {{ article.pages }}{% endif %}.
		{% if article.doi %}DOI:&nbsp;<a href="http://dx.doi.org/{{ article.doi }}">{{ article.doi }}</a>{% endif %}
	</p></li>
	{% endfor %}
	{% set counter = counter + year.list|length %}
</ol>
{% endfor %}
{% endmacro %}

{% block contentbody %}
{{ super() }}
<div>
	{{ render_publication_list() }}
</div>

{% endblock %}
